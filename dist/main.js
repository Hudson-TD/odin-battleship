(()=>{var e={817:e=>{e.exports={renderPlayerCreationEl:function(){const e=document.querySelector("body");let t=document.createElement("div");t.classList.add("player-creation-container");let r=document.createElement("p");r.innerText="You are about to enter unfamiliar waters in an effort to neutralize enemy ships. Due to thick fog our strategy is simple, fire artillery and observe any contact. Intel suggests the enemy fleet contains 5 ships of varying sizes...\n  \n  Instructions:\n  \n  Using arial reconnaissance order fire on mapped coordinates. Hits will be recorded with an explosion marker, while misses will be indicated with a water marker.";let a=document.createElement("form");a.setAttribute("name","player-creation-form"),a.setAttribute("class","player-creation-form");let i=document.createElement("input");i.setAttribute("id","playerName"),i.setAttribute("type","text"),i.setAttribute("min","1"),i.required=!0,i.setAttribute("max","25"),i.setAttribute("placeholder","Enter Player Name");let n=document.createElement("button");n.setAttribute("id","playerSubmit"),n.setAttribute("type","submit"),n.setAttribute("for","player-creation-form"),n.innerText="Launch Fleet",e.appendChild(t),t.appendChild(a),a.appendChild(r),a.appendChild(i),a.appendChild(n)},generateGameboardEl:function(e){const t=[...e.board.grid],r=document.querySelector(".main-content-container"),a=document.createElement("div"),i=document.createElement("table");i.setAttribute("class","gameboard-table");const n=document.createElement("th");n.innerText=`${e.name}'s Fleet`,a.appendChild(n);for(let r=0;r<10;r++){const a=document.createElement("tr");a.setAttribute("class","gameboard-row");for(let i=0;i<10;i++){const n=10*r+i;if(n<t.length){const r=document.createElement("td");a.appendChild(r),r.setAttribute("data-x",`${t[n].x}`),r.setAttribute("data-y",`${t[n].y}`),r.setAttribute("data-attacked",`${t[n].attacked}`),r.setAttribute("data-ship",`${t[n].shipName}`),r.setAttribute("class","gameboard-tile"),"Computer"===e.name&&r.classList.add("enemy-tile")}}i.appendChild(a)}a.appendChild(i),r.appendChild(a)},updateDisplay:function(){document.querySelectorAll(".gameboard-tile").forEach((e=>{let t=e.getAttribute("data-attacked"),r=e.getAttribute("data-ship");"true"===t&&"undefined"===r&&(e.classList.remove("enemy-tile"),e.classList.add("missed")),"true"===t&&"undefined"!==r&&(e.classList.remove("enemy-tile"),e.classList.add("hit"))}))}}},404:(e,t,r)=>{const{renderPlayerCreationEl:a,generateGameboardEl:i,updateDisplay:n}=r(817),{player:s}=r(507);e.exports={game:()=>({playerOneName:void 0,playerTwoName:"Computer",playerOne:void 0,PlayerTwo:void 0,init:function(){a(),this.cacheDom(),this.startEventListening()},cacheDom:function(){this.formContainer=document.querySelector(".player-creation-container"),this.formSubmitBtn=document.getElementById("playerSubmit"),this.formInput=document.getElementById("playerName")},startEventListening:function(){this.formSubmitBtn.addEventListener("click",(e=>{e.preventDefault(),this.playerOneName=this.formInput.value,this.formContainer.classList.add("hidden"),this.handleGameSetup()}))},handleGameSetup:function(){this.playerOne=s(this.playerOneName),this.PlayerTwo=s(this.playerTwoName),this.handlePlotting(),i(this.playerOne),i(this.PlayerTwo),this.startAttackListening()},startAttackListening:function(){document.querySelectorAll(".enemy-tile").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),e.target.setAttribute("data-attacked","true");let t=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");this.PlayerTwo.board.receiveAttack(t,r),n()}))}))},handlePlotting:function(){this.playerOne.board.plotFleet(),this.PlayerTwo.board.plotFleet()}})}},498:(e,t,r)=>{const{ship:a}=r(643);e.exports={gameboard:()=>{let e=[];return{isGameOver:!1,grid:(()=>{for(let t=0;t<10;t++)for(let r=0;r<10;r++)e.push({x:t,y:r,shipName:void 0,attacked:!1});return e})(),missedShots:[],sunkShips:[],myFleet:[a("Carrier"),a("Battleship"),a("Destroyer"),a("Submarine"),a("Patrol Boat")],receiveAttack:function(e,t){console.log(`Hit logged at ${e},${t}`),this.grid.forEach((r=>{if(r.x==e&&r.y==t)if(r.attacked=!0,void 0===r.shipName)this.missedShots.push({x:e,y:t});else switch(r.shipName){case"Carrier":this.myFleet[0].hit();break;case"Battleship":this.myFleet[1].hit();break;case"Destroyer":this.myFleet[2].hit();break;case"Submarine":this.myFleet[3].hit();break;case"Patrol Boat":this.myFleet[4].hit()}}))},plotFleet:function(){this.myFleet.forEach((e=>{e.location.forEach((t=>{this.grid.forEach((r=>{r.x===t.x&&r.y===t.y&&(r.shipName=e.name)}))}))}))},checkSunkShips:function(){this.myFleet.forEach((e=>{!0===e.sunk&&this.sunkShips.push(String(e.name))}))},checkGameOver:function(){5===this.sunkShips.length&&(this.isGameOver=!0)}}}}},225:e=>{const t=()=>Math.floor(10*Math.random());e.exports={randomNumZeroToNine:t,randomDirection:()=>{let e;return e=t()<=4?"horizontal":"vertical",e},determineSafePath:(e,t)=>{let r;return"horizontal"===e?r=t.x<=4?"right":"left":"vertical"===e&&(r=t.y<=4?"down":"up"),r}}},507:(e,t,r)=>{const{gameboard:a}=r(498);e.exports={player:e=>({name:e,isTurn:!1,board:a()})}},643:(e,t,r)=>{const{randomNumZeroToNine:a,randomDirection:i,determineSafePath:n}=r(225);e.exports={ship:e=>{const t=e=>{switch(e){case"Carrier":return Number(5);case"Battleship":return Number(4);case"Destroyer":case"Submarine":return Number(3);case"Patrol Boat":return Number(2);default:throw new Error("Invalid ship type provided")}};return{name:e,length:t(e),hits:0,sunk:!1,location:(e=>{let t=[],r={x:a(),y:a()},s=i();return t=((e,t,r)=>{let a=[];if(a.push(r),"left"==e)for(let e=1;e<t;e++)a.push({x:r.x-e,y:r.y});else if("right"==e)for(let e=1;e<t;e++)a.push({x:r.x+e,y:r.y});else if("up"==e)for(let e=1;e<t;e++)a.push({x:r.x,y:r.y-e});else if("down"==e)for(let e=1;e<t;e++)a.push({x:r.x,y:r.y+e});return a})(n(s,r),e,r),t})(t(e)),hit:function(){this.hits+=1,console.log("Hit detected!"),this.isSunk()},isSunk:function(){this.hits===this.length&&(this.sunk=!0,console.log(`${this.name} has been sunk`))}}}}}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}(()=>{const{game:e}=r(404);e().init()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjdFLEVBQU9vRSxJQUNqQ2pCLElBQUssV0FDSC9CLEtBQUttRCxNQUFRLEVBQ2J2QixRQUFRQyxJQUFJLGlCQUNaN0IsS0FBSzBELFFBQ1AsRUFDQUEsT0FBUSxXQUNGMUQsS0FBS21ELE9BQVNuRCxLQUFLcEIsU0FDckJvQixLQUFLbUMsTUFBTyxFQUNaUCxRQUFRQyxJQUFJLEdBQUc3QixLQUFLekIsc0JBRXhCLEVBQ0QsRSxHQ3RGQ29GLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQmxFLElBQWpCbUUsRUFDSCxPQUFPQSxFQUFhakgsUUFHckIsSUFBSUQsRUFBUytHLEVBQXlCRSxHQUFZLENBR2pEaEgsUUFBUyxDQUFDLEdBT1gsT0FIQWtILEVBQW9CRixHQUFVakgsRUFBUUEsRUFBT0MsUUFBUytHLEdBRy9DaEgsRUFBT0MsT0FDZixDLE1DdEJBLE1BQU0sS0FBRTRDLEdBQVMsRUFBUSxLQUVUQSxJQUNSTSxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2RvbUNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2dhbWVMb2dpYy5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9oZWxwZXJzLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiByZW5kZXJQbGF5ZXJDcmVhdGlvbkVsKCkge1xuICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XG4gIGxldCBjb250YWluZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnRhaW5lckVsLmNsYXNzTGlzdC5hZGQoXCJwbGF5ZXItY3JlYXRpb24tY29udGFpbmVyXCIpO1xuXG4gIGxldCBvdmVydmlld1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcblxuICBvdmVydmlld1RleHQuaW5uZXJUZXh0ID0gYFlvdSBhcmUgYWJvdXQgdG8gZW50ZXIgdW5mYW1pbGlhciB3YXRlcnMgaW4gYW4gZWZmb3J0IHRvIG5ldXRyYWxpemUgZW5lbXkgc2hpcHMuIER1ZSB0byB0aGljayBmb2cgb3VyIHN0cmF0ZWd5IGlzIHNpbXBsZSwgZmlyZSBhcnRpbGxlcnkgYW5kIG9ic2VydmUgYW55IGNvbnRhY3QuIEludGVsIHN1Z2dlc3RzIHRoZSBlbmVteSBmbGVldCBjb250YWlucyA1IHNoaXBzIG9mIHZhcnlpbmcgc2l6ZXMuLi5cbiAgXG4gIEluc3RydWN0aW9uczpcbiAgXG4gIFVzaW5nIGFyaWFsIHJlY29ubmFpc3NhbmNlIG9yZGVyIGZpcmUgb24gbWFwcGVkIGNvb3JkaW5hdGVzLiBIaXRzIHdpbGwgYmUgcmVjb3JkZWQgd2l0aCBhbiBleHBsb3Npb24gbWFya2VyLCB3aGlsZSBtaXNzZXMgd2lsbCBiZSBpbmRpY2F0ZWQgd2l0aCBhIHdhdGVyIG1hcmtlci5gO1xuXG4gIGxldCBmb3JtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcbiAgZm9ybUVsLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJwbGF5ZXItY3JlYXRpb24tZm9ybVwiKTtcbiAgZm9ybUVsLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicGxheWVyLWNyZWF0aW9uLWZvcm1cIik7XG5cbiAgbGV0IGlucHV0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gIGlucHV0RWwuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJOYW1lXCIpO1xuICBpbnB1dEVsLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJ0ZXh0XCIpO1xuICBpbnB1dEVsLnNldEF0dHJpYnV0ZShcIm1pblwiLCBcIjFcIik7XG4gIGlucHV0RWwucmVxdWlyZWQgPSB0cnVlO1xuICBpbnB1dEVsLnNldEF0dHJpYnV0ZShcIm1heFwiLCBcIjI1XCIpO1xuICBpbnB1dEVsLnNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIFwiRW50ZXIgUGxheWVyIE5hbWVcIik7XG5cbiAgbGV0IGJ0bkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgYnRuRWwuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJTdWJtaXRcIik7XG4gIGJ0bkVsLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XG4gIGJ0bkVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInBsYXllci1jcmVhdGlvbi1mb3JtXCIpO1xuICBidG5FbC5pbm5lclRleHQgPSBcIkxhdW5jaCBGbGVldFwiO1xuXG4gIGJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyRWwpO1xuICBjb250YWluZXJFbC5hcHBlbmRDaGlsZChmb3JtRWwpO1xuICBmb3JtRWwuYXBwZW5kQ2hpbGQob3ZlcnZpZXdUZXh0KTtcbiAgZm9ybUVsLmFwcGVuZENoaWxkKGlucHV0RWwpO1xuICBmb3JtRWwuYXBwZW5kQ2hpbGQoYnRuRWwpO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUdhbWVib2FyZEVsKHBsYXllcikge1xuICBjb25zdCBkYXRhQXJyYXkgPSBbLi4ucGxheWVyLmJvYXJkLmdyaWRdO1xuICBjb25zdCBtYWluQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWNvbnRlbnQtY29udGFpbmVyXCIpO1xuICBjb25zdCB0YWJsZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRhYmxlXCIpO1xuICB0YWJsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImdhbWVib2FyZC10YWJsZVwiKTtcbiAgY29uc3QgcGxheWVySGVhZGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiKTtcbiAgcGxheWVySGVhZGluZy5pbm5lclRleHQgPSBgJHtwbGF5ZXIubmFtZX0ncyBGbGVldGA7XG4gIHRhYmxlQ29udGFpbmVyLmFwcGVuZENoaWxkKHBsYXllckhlYWRpbmcpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcbiAgICByb3cuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJnYW1lYm9hcmQtcm93XCIpO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICBjb25zdCBkYXRhSW5kZXggPSBpICogMTAgKyBqO1xuXG4gICAgICBpZiAoZGF0YUluZGV4IDwgZGF0YUFycmF5Lmxlbmd0aCkge1xuICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY2VsbCk7XG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKFwiZGF0YS14XCIsIGAke2RhdGFBcnJheVtkYXRhSW5kZXhdLnh9YCk7XG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKFwiZGF0YS15XCIsIGAke2RhdGFBcnJheVtkYXRhSW5kZXhdLnl9YCk7XG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKFwiZGF0YS1hdHRhY2tlZFwiLCBgJHtkYXRhQXJyYXlbZGF0YUluZGV4XS5hdHRhY2tlZH1gKTtcbiAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNoaXBcIiwgYCR7ZGF0YUFycmF5W2RhdGFJbmRleF0uc2hpcE5hbWV9YCk7XG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJnYW1lYm9hcmQtdGlsZVwiKTtcbiAgICAgICAgLy8gT25seSBhZGQgZXZlbnQgbGlzdGVuZXJzIHRvIGVuZW15IGdhbWVib2FyZFxuICAgICAgICBpZiAocGxheWVyLm5hbWUgPT09IFwiQ29tcHV0ZXJcIikge1xuICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcImVuZW15LXRpbGVcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdGFibGUuYXBwZW5kQ2hpbGQocm93KTtcbiAgfVxuICB0YWJsZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0YWJsZSk7XG4gIG1haW5Db250YWluZXIuYXBwZW5kQ2hpbGQodGFibGVDb250YWluZXIpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVEaXNwbGF5KCkge1xuICBjb25zdCBhbGxHcmlkSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmdhbWVib2FyZC10aWxlXCIpO1xuICBhbGxHcmlkSXRlbXMuZm9yRWFjaCgodGlsZSkgPT4ge1xuICAgIGxldCBzdGF0dXMgPSB0aWxlLmdldEF0dHJpYnV0ZShcImRhdGEtYXR0YWNrZWRcIik7XG4gICAgbGV0IG5hbWUgPSB0aWxlLmdldEF0dHJpYnV0ZShcImRhdGEtc2hpcFwiKTtcbiAgICBpZiAoc3RhdHVzID09PSBcInRydWVcIiAmJiBuYW1lID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB0aWxlLmNsYXNzTGlzdC5yZW1vdmUoXCJlbmVteS10aWxlXCIpO1xuICAgICAgdGlsZS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IFwidHJ1ZVwiICYmIG5hbWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHRpbGUuY2xhc3NMaXN0LnJlbW92ZShcImVuZW15LXRpbGVcIik7XG4gICAgICB0aWxlLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XG4gICAgfVxuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IHJlbmRlclBsYXllckNyZWF0aW9uRWwsIGdlbmVyYXRlR2FtZWJvYXJkRWwsIHVwZGF0ZURpc3BsYXkgfTtcbiIsImNvbnN0IHtcbiAgcmVuZGVyUGxheWVyQ3JlYXRpb25FbCxcbiAgZ2VuZXJhdGVHYW1lYm9hcmRFbCxcbiAgdXBkYXRlRGlzcGxheSxcbn0gPSByZXF1aXJlKFwiLi9kb21Db250cm9sbGVyXCIpO1xuY29uc3QgeyBwbGF5ZXIgfSA9IHJlcXVpcmUoXCIuL3BsYXllclwiKTtcblxuY29uc3QgZ2FtZSA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBwbGF5ZXJPbmVOYW1lOiB1bmRlZmluZWQsXG4gICAgcGxheWVyVHdvTmFtZTogXCJDb21wdXRlclwiLFxuICAgIHBsYXllck9uZTogdW5kZWZpbmVkLFxuICAgIFBsYXllclR3bzogdW5kZWZpbmVkLFxuICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJlbmRlclBsYXllckNyZWF0aW9uRWwoKTtcbiAgICAgIHRoaXMuY2FjaGVEb20oKTtcbiAgICAgIHRoaXMuc3RhcnRFdmVudExpc3RlbmluZygpO1xuICAgIH0sXG4gICAgY2FjaGVEb206IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZm9ybUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLWNyZWF0aW9uLWNvbnRhaW5lclwiKTtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyU3VibWl0XCIpO1xuICAgICAgdGhpcy5mb3JtSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllck5hbWVcIik7XG4gICAgfSxcbiAgICBzdGFydEV2ZW50TGlzdGVuaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmZvcm1TdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wbGF5ZXJPbmVOYW1lID0gdGhpcy5mb3JtSW5wdXQudmFsdWU7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgICAgICB0aGlzLmhhbmRsZUdhbWVTZXR1cCgpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBoYW5kbGVHYW1lU2V0dXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucGxheWVyT25lID0gcGxheWVyKHRoaXMucGxheWVyT25lTmFtZSk7XG4gICAgICB0aGlzLlBsYXllclR3byA9IHBsYXllcih0aGlzLnBsYXllclR3b05hbWUpO1xuICAgICAgdGhpcy5oYW5kbGVQbG90dGluZygpO1xuICAgICAgZ2VuZXJhdGVHYW1lYm9hcmRFbCh0aGlzLnBsYXllck9uZSk7XG4gICAgICBnZW5lcmF0ZUdhbWVib2FyZEVsKHRoaXMuUGxheWVyVHdvKTtcbiAgICAgIHRoaXMuc3RhcnRBdHRhY2tMaXN0ZW5pbmcoKTtcbiAgICB9LFxuICAgIHN0YXJ0QXR0YWNrTGlzdGVuaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZW5lbXktdGlsZVwiKTtcbiAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZS50YXJnZXQuc2V0QXR0cmlidXRlKFwiZGF0YS1hdHRhY2tlZFwiLCBcInRydWVcIik7XG4gICAgICAgICAgbGV0IHggPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIik7XG4gICAgICAgICAgbGV0IHkgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIik7XG4gICAgICAgICAgdGhpcy5QbGF5ZXJUd28uYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICAgICAgICB1cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBoYW5kbGVQbG90dGluZzogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5wbGF5ZXJPbmUuYm9hcmQucGxvdEZsZWV0KCk7XG4gICAgICB0aGlzLlBsYXllclR3by5ib2FyZC5wbG90RmxlZXQoKTtcbiAgICB9LFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7IGdhbWUgfTtcbiIsImNvbnN0IHsgc2hpcCB9ID0gcmVxdWlyZShcIi4vc2hpcFwiKTtcblxuY29uc3QgZ2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgZ3JpZEFyciA9IFtdO1xuXG4gIGNvbnN0IGdlbmVyYXRlR3JpZCA9ICgpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBncmlkQXJyLnB1c2goe1xuICAgICAgICAgIHg6IGksXG4gICAgICAgICAgeTogaixcbiAgICAgICAgICBzaGlwTmFtZTogdW5kZWZpbmVkLFxuICAgICAgICAgIGF0dGFja2VkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGdyaWRBcnI7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpc0dhbWVPdmVyOiBmYWxzZSxcbiAgICBncmlkOiBnZW5lcmF0ZUdyaWQoKSxcbiAgICBtaXNzZWRTaG90czogW10sXG4gICAgc3Vua1NoaXBzOiBbXSxcbiAgICBteUZsZWV0OiBbXG4gICAgICBzaGlwKFwiQ2FycmllclwiKSxcbiAgICAgIHNoaXAoXCJCYXR0bGVzaGlwXCIpLFxuICAgICAgc2hpcChcIkRlc3Ryb3llclwiKSxcbiAgICAgIHNoaXAoXCJTdWJtYXJpbmVcIiksXG4gICAgICBzaGlwKFwiUGF0cm9sIEJvYXRcIiksXG4gICAgXSxcbiAgICByZWNlaXZlQXR0YWNrOiBmdW5jdGlvbiAoeENvb3JkLCB5Q29vcmQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBIaXQgbG9nZ2VkIGF0ICR7eENvb3JkfSwke3lDb29yZH1gKTtcbiAgICAgIHRoaXMuZ3JpZC5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgICAgaWYgKG9iai54ID09IHhDb29yZCAmJiBvYmoueSA9PSB5Q29vcmQpIHtcbiAgICAgICAgICBvYmouYXR0YWNrZWQgPSB0cnVlO1xuICAgICAgICAgIGlmIChvYmouc2hpcE5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5taXNzZWRTaG90cy5wdXNoKHsgeDogeENvb3JkLCB5OiB5Q29vcmQgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAob2JqLnNoaXBOYW1lKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJDYXJyaWVyXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5teUZsZWV0WzBdLmhpdCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIFwiQmF0dGxlc2hpcFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubXlGbGVldFsxXS5oaXQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcIkRlc3Ryb3llclwiOlxuICAgICAgICAgICAgICAgIHRoaXMubXlGbGVldFsyXS5oaXQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcIlN1Ym1hcmluZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMubXlGbGVldFszXS5oaXQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcIlBhdHJvbCBCb2F0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5teUZsZWV0WzRdLmhpdCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHBsb3RGbGVldDogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGZsZWV0ID0gdGhpcy5teUZsZWV0O1xuICAgICAgZmxlZXQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICBsZXQgcGxvdHMgPSBzaGlwLmxvY2F0aW9uO1xuICAgICAgICBwbG90cy5mb3JFYWNoKChjb29yZCkgPT4ge1xuICAgICAgICAgIHRoaXMuZ3JpZC5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgICAgICAgIGlmIChvYmoueCA9PT0gY29vcmQueCAmJiBvYmoueSA9PT0gY29vcmQueSkge1xuICAgICAgICAgICAgICBvYmouc2hpcE5hbWUgPSBzaGlwLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBjaGVja1N1bmtTaGlwczogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGZsZWV0ID0gdGhpcy5teUZsZWV0O1xuICAgICAgZmxlZXQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICBpZiAoc2hpcC5zdW5rID09PSB0cnVlKSB7XG4gICAgICAgICAgdGhpcy5zdW5rU2hpcHMucHVzaChTdHJpbmcoc2hpcC5uYW1lKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjaGVja0dhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5zdW5rU2hpcHMubGVuZ3RoID09PSA1KSB7XG4gICAgICAgIHRoaXMuaXNHYW1lT3ZlciA9IHRydWU7XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBnYW1lYm9hcmQgfTtcbiIsImNvbnN0IHJhbmRvbU51bVplcm9Ub05pbmUgPSAoKSA9PiB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG59O1xuXG5jb25zdCByYW5kb21EaXJlY3Rpb24gPSAoKSA9PiB7XG4gIGxldCBkaXJlY3Rpb247XG4gIGxldCBjb2luRmxpcCA9IHJhbmRvbU51bVplcm9Ub05pbmUoKTtcblxuICBpZiAoY29pbkZsaXAgPD0gNCkge1xuICAgIGRpcmVjdGlvbiA9IFwiaG9yaXpvbnRhbFwiO1xuICB9IGVsc2Uge1xuICAgIGRpcmVjdGlvbiA9IFwidmVydGljYWxcIjtcbiAgfVxuXG4gIHJldHVybiBkaXJlY3Rpb247XG59O1xuXG5jb25zdCBkZXRlcm1pbmVTYWZlUGF0aCA9IChkaXJlY3Rpb24sIHN0YXJ0KSA9PiB7XG4gIGxldCBwYXRoO1xuXG4gIGlmIChkaXJlY3Rpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgaWYgKHN0YXJ0LnggPD0gNCkge1xuICAgICAgcGF0aCA9IFwicmlnaHRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcGF0aCA9IFwibGVmdFwiO1xuICAgIH1cbiAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09IFwidmVydGljYWxcIikge1xuICAgIGlmIChzdGFydC55IDw9IDQpIHtcbiAgICAgIHBhdGggPSBcImRvd25cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcGF0aCA9IFwidXBcIjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhdGg7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgcmFuZG9tTnVtWmVyb1RvTmluZSwgcmFuZG9tRGlyZWN0aW9uLCBkZXRlcm1pbmVTYWZlUGF0aCB9O1xuIiwiY29uc3QgeyBnYW1lYm9hcmQgfSA9IHJlcXVpcmUoXCIuL2dhbWVib2FyZC5qc1wiKTtcblxuY29uc3QgcGxheWVyID0gKG5hbWUpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBuYW1lOiBuYW1lLFxuICAgIGlzVHVybjogZmFsc2UsXG4gICAgYm9hcmQ6IGdhbWVib2FyZCgpLFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7IHBsYXllciB9O1xuIiwiY29uc3Qge1xuICByYW5kb21OdW1aZXJvVG9OaW5lLFxuICByYW5kb21EaXJlY3Rpb24sXG4gIGRldGVybWluZVNhZmVQYXRoLFxufSA9IHJlcXVpcmUoXCIuL2hlbHBlcnMuanNcIik7XG5cbmNvbnN0IHNoaXAgPSAodHlwZSkgPT4ge1xuICBjb25zdCBsZW5ndGggPSAodHlwZSkgPT4ge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSBcIkNhcnJpZXJcIjpcbiAgICAgICAgcmV0dXJuIE51bWJlcig1KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiQmF0dGxlc2hpcFwiOlxuICAgICAgICByZXR1cm4gTnVtYmVyKDQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJEZXN0cm95ZXJcIjpcbiAgICAgICAgcmV0dXJuIE51bWJlcigzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiU3VibWFyaW5lXCI6XG4gICAgICAgIHJldHVybiBOdW1iZXIoMyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIlBhdHJvbCBCb2F0XCI6XG4gICAgICAgIHJldHVybiBOdW1iZXIoMik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzaGlwIHR5cGUgcHJvdmlkZWRcIik7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZW5lcmF0ZUNvb3JkaW5hdGVzID0gKHBhdGgsIGxlbmd0aCwgc3RhcnQpID0+IHtcbiAgICBsZXQgbGlzdCA9IFtdO1xuICAgIGxpc3QucHVzaChzdGFydCk7XG5cbiAgICBpZiAocGF0aCA9PSBcImxlZnRcIikge1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBsaXN0LnB1c2goeyB4OiBzdGFydC54IC0gaSwgeTogc3RhcnQueSB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHBhdGggPT0gXCJyaWdodFwiKSB7XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxpc3QucHVzaCh7IHg6IHN0YXJ0LnggKyBpLCB5OiBzdGFydC55IH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAocGF0aCA9PSBcInVwXCIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGlzdC5wdXNoKHsgeDogc3RhcnQueCwgeTogc3RhcnQueSAtIGkgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChwYXRoID09IFwiZG93blwiKSB7XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxpc3QucHVzaCh7IHg6IHN0YXJ0LngsIHk6IHN0YXJ0LnkgKyBpIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbGlzdDtcbiAgfTtcblxuICBjb25zdCByYW5kb21QbGFjZW1lbnQgPSAoc2hpcExlbmd0aCkgPT4ge1xuICAgIGxldCBzaGlwQ29vcmRpbmF0ZXMgPSBbXTtcbiAgICBsZXQgc3RhcnRpbmdQb2ludCA9IHtcbiAgICAgIHg6IHJhbmRvbU51bVplcm9Ub05pbmUoKSxcbiAgICAgIHk6IHJhbmRvbU51bVplcm9Ub05pbmUoKSxcbiAgICB9O1xuXG4gICAgbGV0IGRpcmVjdGlvbiA9IHJhbmRvbURpcmVjdGlvbigpO1xuXG4gICAgbGV0IHBhdGggPSBkZXRlcm1pbmVTYWZlUGF0aChkaXJlY3Rpb24sIHN0YXJ0aW5nUG9pbnQpO1xuXG4gICAgc2hpcENvb3JkaW5hdGVzID0gZ2VuZXJhdGVDb29yZGluYXRlcyhwYXRoLCBzaGlwTGVuZ3RoLCBzdGFydGluZ1BvaW50KTtcblxuICAgIHJldHVybiBzaGlwQ29vcmRpbmF0ZXM7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBuYW1lOiB0eXBlLFxuICAgIGxlbmd0aDogbGVuZ3RoKHR5cGUpLFxuICAgIGhpdHM6IDAsXG4gICAgc3VuazogZmFsc2UsXG4gICAgbG9jYXRpb246IHJhbmRvbVBsYWNlbWVudChsZW5ndGgodHlwZSkpLFxuICAgIGhpdDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5oaXRzICs9IDE7XG4gICAgICBjb25zb2xlLmxvZyhcIkhpdCBkZXRlY3RlZCFcIik7XG4gICAgICB0aGlzLmlzU3VuaygpO1xuICAgIH0sXG4gICAgaXNTdW5rOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5oaXRzID09PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZyhgJHt0aGlzLm5hbWV9IGhhcyBiZWVuIHN1bmtgKTtcbiAgICAgIH1cbiAgICB9LFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7IHNoaXAgfTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJjb25zdCB7IGdhbWUgfSA9IHJlcXVpcmUoXCIuL2dhbWVMb2dpY1wiKTtcblxuY29uc3QgbmV3R2FtZSA9IGdhbWUoKTtcbm5ld0dhbWUuaW5pdCgpO1xuIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJyZW5kZXJQbGF5ZXJDcmVhdGlvbkVsIiwiYm9keSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRhaW5lckVsIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsIm92ZXJ2aWV3VGV4dCIsImlubmVyVGV4dCIsImZvcm1FbCIsInNldEF0dHJpYnV0ZSIsImlucHV0RWwiLCJyZXF1aXJlZCIsImJ0bkVsIiwiYXBwZW5kQ2hpbGQiLCJnZW5lcmF0ZUdhbWVib2FyZEVsIiwicGxheWVyIiwiZGF0YUFycmF5IiwiYm9hcmQiLCJncmlkIiwibWFpbkNvbnRhaW5lciIsInRhYmxlQ29udGFpbmVyIiwidGFibGUiLCJwbGF5ZXJIZWFkaW5nIiwibmFtZSIsImkiLCJyb3ciLCJqIiwiZGF0YUluZGV4IiwibGVuZ3RoIiwiY2VsbCIsIngiLCJ5IiwiYXR0YWNrZWQiLCJzaGlwTmFtZSIsInVwZGF0ZURpc3BsYXkiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInRpbGUiLCJzdGF0dXMiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmUiLCJnYW1lIiwicGxheWVyT25lTmFtZSIsInVuZGVmaW5lZCIsInBsYXllclR3b05hbWUiLCJwbGF5ZXJPbmUiLCJQbGF5ZXJUd28iLCJpbml0IiwidGhpcyIsImNhY2hlRG9tIiwic3RhcnRFdmVudExpc3RlbmluZyIsImZvcm1Db250YWluZXIiLCJmb3JtU3VibWl0QnRuIiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JtSW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJoYW5kbGVHYW1lU2V0dXAiLCJoYW5kbGVQbG90dGluZyIsInN0YXJ0QXR0YWNrTGlzdGVuaW5nIiwidGFyZ2V0IiwicmVjZWl2ZUF0dGFjayIsInBsb3RGbGVldCIsInNoaXAiLCJnYW1lYm9hcmQiLCJncmlkQXJyIiwiaXNHYW1lT3ZlciIsInB1c2giLCJnZW5lcmF0ZUdyaWQiLCJtaXNzZWRTaG90cyIsInN1bmtTaGlwcyIsIm15RmxlZXQiLCJ4Q29vcmQiLCJ5Q29vcmQiLCJjb25zb2xlIiwibG9nIiwib2JqIiwiaGl0IiwibG9jYXRpb24iLCJjb29yZCIsImNoZWNrU3Vua1NoaXBzIiwic3VuayIsIlN0cmluZyIsImNoZWNrR2FtZU92ZXIiLCJyYW5kb21OdW1aZXJvVG9OaW5lIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tRGlyZWN0aW9uIiwiZGlyZWN0aW9uIiwiZGV0ZXJtaW5lU2FmZVBhdGgiLCJzdGFydCIsInBhdGgiLCJpc1R1cm4iLCJ0eXBlIiwiTnVtYmVyIiwiRXJyb3IiLCJoaXRzIiwic2hpcExlbmd0aCIsInNoaXBDb29yZGluYXRlcyIsInN0YXJ0aW5nUG9pbnQiLCJsaXN0IiwiZ2VuZXJhdGVDb29yZGluYXRlcyIsInJhbmRvbVBsYWNlbWVudCIsImlzU3VuayIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwic291cmNlUm9vdCI6IiJ9